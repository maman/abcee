/*
 * jQuery.event.swipe
 * Copyright (c) 2012 Stephen Band
 */
 (function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e,t){function o(e){var t,n,r;t=e.target.offsetWidth;n=e.target.offsetHeight;r={distX:e.distX,distY:e.distY,velocityX:e.velocityX,velocityY:e.velocityY,finger:e.finger};if(e.distX>e.distY){if(e.distX>-e.distY){if(e.distX/t>s.threshold||e.velocityX*e.distX/t*s.sensitivity>1){r.type="swiperight";i(e.currentTarget,r)}}else{if(-e.distY/n>s.threshold||e.velocityY*e.distY/t*s.sensitivity>1){r.type="swipeup";i(e.currentTarget,r)}}}else{if(e.distX>-e.distY){if(e.distY/n>s.threshold||e.velocityY*e.distY/t*s.sensitivity>1){r.type="swipedown";i(e.currentTarget,r)}}else{if(-e.distX/t>s.threshold||e.velocityX*e.distX/t*s.sensitivity>1){r.type="swipeleft";i(e.currentTarget,r)}}}}function u(t){var n=e.data(t,"event_swipe");if(!n){n={count:0};e.data(t,"event_swipe",n)}return n}var n=e.event.add,r=e.event.remove,i=function(t,n,r){e.event.trigger(n,r,t)},s={threshold:.4,sensitivity:6};e.event.special.swipe=e.event.special.swipeleft=e.event.special.swiperight=e.event.special.swipeup=e.event.special.swipedown={setup:function(e,t,r){var e=u(this);if(e.count++>0){return}n(this,"moveend",o);return true},teardown:function(){var e=u(this);if(--e.count>0){return}r(this,"moveend",o);return true},settings:s}});

/*
 * jCanvas v13.05.25
 * Copyright 2013 Caleb Evans
 */
 (function(e,t,n,r,i,s,o,u,a){function f(e){I(this,e);return this}function l(e){e?I(f.prototype,e):l.prefs=f.prototype=I({},F);return this}function c(e){return"string"===R(e)}function h(e){return e&&e.getContext?e.getContext("2d"):u}function p(e,t){e.fillStyle=t.fillStyle;e.strokeStyle=t.strokeStyle;e.lineWidth=t.strokeWidth;t.rounded?(e.lineCap="round",e.lineJoin="round"):(e.lineCap=t.strokeCap,e.lineJoin=t.strokeJoin,e.miterLimit=t.miterLimit);e.shadowOffsetX=t.shadowX;e.shadowOffsetY=t.shadowY;e.shadowBlur=t.shadowBlur;e.shadowColor=t.shadowColor;e.globalAlpha=t.opacity;e.globalCompositeOperation=t.compositing;t.imageSmoothing&&(e.webkitimageSmoothingEnabled=e.mozimageSmoothingEnabled=t.imageSmoothing)}function d(e,t,n){n.mask&&(n.autosave&&(e.save(),t.savedTransforms=I({},t.transforms),t.transforms.masks+=1,t.transforms.withinMask=e.isPointInPath(t.event.x,t.event.y)?s:o),e.clip())}function v(e,t,n){n.layer&&(n._args.withinMask=t.transforms.withinMask===s||t.transforms.withinMask===u?s:o)}function m(e,t,n){n.closed&&t.closePath();n.shadowStroke&&0!==n.strokeWidth?(t.stroke(),t.fill(),t.shadowColor="transparent",t.shadowBlur=0,t.stroke()):(t.fill(),"transparent"!==n.fillStyle&&(t.shadowColor="transparent"),0!==n.strokeWidth&&t.stroke());n.closed||t.closePath();n._transformed&&t.restore();if(n.mask||n.layer)e=E(e),d(t,e,n),v(t,e,n)}function g(e,t,n){t._toRad=t.inDegrees?W/180:1;e.translate(t.x,t.y);e.rotate(t.rotate*t._toRad);e.translate(-t.x,-t.y);n.rotate+=t.rotate*t._toRad}function y(e,t,n){1!==t.scale&&(t.scaleX=t.scaleY=t.scale);e.translate(t.x,t.y);e.scale(t.scaleX,t.scaleY);e.translate(-t.x,-t.y);n.scaleX*=t.scaleX;n.scaleY*=t.scaleY}function b(e,t,n){t.translate&&(t.translateX=t.translateY=t.translate);e.translate(t.translateX,t.translateY);n.translateX+=t.translateX;n.translateY+=t.translateY}function w(e,t,n,r){t._toRad=t.inDegrees?W/180:1;t._transformed=s;e.save();r===a&&(r=n);!t.fromCenter&&!t._centered&&(t.x+=n/2,t.y+=r/2,t._centered=s);t.rotate&&g(e,t,{});(1!==t.scale||1!==t.scaleX||1!==t.scaleY)&&y(e,t,{});(t.translate||t.translateX||t.translateY)&&b(e,t,{})}function E(t){var n;G._canvas===t&&G._data?n=G._data:(n=e.data(t,"jCanvas"),n||(n={canvas:t,layers:[],layer:{names:{},groups:{}},intersects:[],drag:{},event:{type:u,x:u,y:u},events:{},transforms:{rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:0,withinMask:u},animating:o,animated:u},n.savedTransforms=I({},n.transforms),e.data(t,"jCanvas",n)),G._canvas=t,G._data=n);return n}function S(e,t,n){for(var r in l.events)if(l.events.hasOwnProperty(r)){var i=e,o=t,u=n,a=r;u[a]&&(a=M(a),l.events[a](i,o),u._event=s)}}function x(e,t,n){var r,i,o;if(n.draggable||n.dragGroupWithLayer||n.cursor){r=["mousedown","mousemove","mouseup"];for(o=0;o<r.length;o+=1)i=M(r[o]),l.events[i](e,t);t.events.mouseoutdrag||(e.bind("mouseout.jCanvas",function(){var n=t.drag.layer;n&&(t.drag={},e.drawLayers(),n.dragcancel&&n.dragcancel.call(e[0],n))}),t.events.mouseoutdrag=s);n._event=s}}function T(e,t,n,r){e=t.layer.names;r?r.name!==a&&c(n.name)&&n.group!==r.group&&delete e[n.name]:r=n;c(r.name)&&(e[r.name]=n)}function N(e,t,n,r){e=t.layer.groups;var i,s;if(r){if(r.group!==a&&c(n.group)&&n.group!==r.group&&(t=e[n.group])){for(s=0;s<t.length;s+=1)if(t[s]===n){i=s;t.splice(s,1);break}0===t.length&&delete e[n.group]}}else r=n;c(r.group)&&(t=e[r.group],t||(t=e[r.group]=[],t.name=r.group),i===a&&(i=t.length),t.splice(i,0,n))}function C(t,n,r,i){var o=r;n._args=r;n.canvas=t;n.draggable&&(n.layer=s,n.draggable=s);n._method=i?i:n.method?e.fn[n.method]:n.type?e.fn[Q[n.type]]:function(){};n.layer&&!n._layer&&(r=e(t),i=r.getLayers(),t=E(t),o=new f(n),T(r,t,o),N(r,t,o),S(r,t,o),x(r,t,o),o.layer=s,o._layer=s,o.index===a&&(o.index=i.length),i.splice(o.index,0,o));return o}function k(e){var t;for(t=0;t<Y.length;t+=1)e[Y[t]]=e["_"+Y[t]]}function L(e,t){var n;for(n=0;n<Y.length;n+=1)e["_"+Y[n]]=e[Y[n]],Z[Y[n]]=1,t&&delete e[Y[n]]}function A(n){var r,s,o=[],u=1;n.match(/^#?\w+$/i)&&("transparent"===n&&(n="rgba(0,0,0,0)"),s=t.head,r=s.style.color,s.style.color=n,n=e.css(s,"color"),s.style.color=r);n.match(/^rgb/i)&&(o=n.match(/\d+/gi),n.match(/%/gi)&&(u=2.55),o[0]*=u,o[1]*=u,o[2]*=u,o[3]=o[3]!==a?i(o[3]):1);return o}function O(e){var t=3,n;"array"!==R(e.start)&&(e.start=A(e.start),e.end=A(e.end));e.now=[];if(1!==e.start[3]||1!==e.end[3])t=4;for(n=0;n<t;n+=1)e.now[n]=e.start[n]+(e.end[n]-e.start[n])*e.pos,3>n&&(e.now[n]=z(e.now[n]));1!==e.start[3]||1!==e.end[3]?e.now="rgba("+e.now.join(",")+")":(e.now.slice(0,3),e.now="rgb("+e.now.join(",")+")");e.elem.nodeName?e.elem.style[e.prop]=e.now:e.elem[e.prop]=e.now}function M(e){"ontouchstart"in window&&J[e]&&(e=J[e]);return e}function _(e){l.events[e]=function(t,n){e=M(e);var r="mouseover"===e||"mouseout"===e?"mousemove":e,i=n.event;n.events[r]||(t.bind(r+".jCanvas",function(e){i.x=e.offsetX;i.y=e.offsetY;i.type=r;i.event=e;t.drawLayers({resetFire:s});e.preventDefault()}),n.events[r]=s)}}function D(e,t,n){var r,i,o,a;n=n._args;n._event&&(e=E(e),r=e.event,r.x!==u&&r.y!==u&&(i=t.isPointInPath(r.x,r.y)||t.isPointInStroke&&t.isPointInStroke(r.x,r.y)),t=e.transforms,n.eventX=n.mouseX=r.x,n.eventY=n.mouseY=r.y,n.event=r.event,a=e.transforms.rotate,r=n.eventX,o=n.eventY,0!==a?(n._eventX=r*V(-a)-o*X(-a),n._eventY=o*V(-a)+r*X(-a)):(n._eventX=r,n._eventY=o),n._eventX/=t.scaleX,n._eventY/=t.scaleY,!i&&n._hovered&&!n._fired&&(n._mousedout=s),i&&e.intersects.push(n))}function P(e,t,n,r,i){t.save();t.beginPath();t.rect(r[0],i[0],r[1]-r[0],i[1]-i[0]);t.clip();w(t,n,0);t.beginPath()}function H(e,t,n){n._event&&D(e,t,n);t.restore();m(e,t,n)}function B(e,t){t.font?e.font=t.font:(isNaN(Number(t.fontSize))||(t.fontSize+="px"),e.font=t.fontStyle+" "+t.fontSize+" "+t.fontFamily)}function j(e,t){var n=t.text,r=t.maxWidth,i=n.split(" "),s=[],o="";if(e.measureText(n).width<r||1===i.length)s=[n];else{for(n=0;n<i.length;n+=1)e.measureText(o+i[n]).width>r&&(""!==o&&s.push(o),o=""),o+=i[n],n!==i.length-1&&(o+=" ");s.push(o)}return s=s.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}var F,I=e.extend,q=e.inArray,R=e.type,U=e.isFunction,z=r.round,W=r.PI,X=r.sin,V=r.cos,$=e.event.fix,J,K,Q,G={},Y,Z;e.fn.jCanvas=l;l.events={};F={align:"center",autosave:s,baseline:"middle",bringToFront:o,ccw:o,closed:o,compositing:"source-over",concavity:0,cornerRadius:0,cropFromCenter:s,disableDrag:o,disableEvents:o,domain:u,draggable:o,group:u,data:{},each:u,end:360,fillStyle:"transparent",font:"",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:s,fn:u,graph:"y",height:u,imageSmoothing:s,inDegrees:s,lineHeight:1,layer:o,load:u,mask:o,maxWidth:u,miterLimit:10,name:u,opacity:1,projection:0,r1:u,r2:u,radius:0,range:u,repeat:"repeat",respectAlign:o,rotate:0,rounded:o,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:!1,shadowX:0,shadowY:0,sHeight:u,sides:0,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:u,sx:u,sy:u,text:"",translate:0,translateX:0,translateY:0,type:u,visible:s,width:u,x:0,y:0};l();l.extend=function(t){l.defaults=I(F,t.props);l();t.name&&(e.fn[t.name]=function n(e){var r,i,s,o=new f(e);for(i=0;i<this.length;i+=1)if(r=this[i],s=h(r))e=C(r,o,e,n),p(s,o),t.fn.call(r,s,o);return this});return e.fn[t.name]};e.fn.getLayers=function(e){var t=this[0],n,r,i=[];if(t&&t.getContext)if(n=E(t).layers,U(e))for(r=0;r<n.length;r+=1)e.call(t,n[r])&&i.push(n[r]);else i=n;return i};e.fn.getLayer=function(t){var n=this.getLayers(),r=e.type(t),i=E(this[0]),s;if(t&&t.layer)s=t;else if("number"===r)0>t&&(t=n.length+t),s=n[t];else if("regexp"===r)for(r=0;r<n.length;r+=1){if(c(n[r].name)&&n[r].name.match(t)){s=n[r];break}}else i=E(this[0]),s=i.layer.names[t];return s};e.fn.getLayerGroup=function(t){var n=e.type(t),r,i;if("array"===n)return t;if("regexp"===n)for(r in n=E(this[0]),n=n.groups,n){if(r.match(t)){i=n[r];break}}else n=E(this[0]),i=n.layer.groups[t];return i};e.fn.getLayerIndex=function(e){var t=this.getLayers();e=this.getLayer(e);return q(e,t)};e.fn.setLayer=function(t,n){var r,i,s,o;for(i=0;i<this.length;i+=1)if(r=e(this[i]),s=E(this[i]),o=e(this[i]).getLayer(t))T(r,s,o,n),N(r,s,o,n),I(o,n),S(r,s,o),x(r,s,o);return this};e.fn.setLayerGroup=function(t,n){var r,i,s,o;for(i=0;i<this.length;i+=1)if(r=e(this[i]),s=r.getLayerGroup(t))for(o=0;o<s.length;o+=1)r.setLayer(s[o],n);return this};e.fn.setLayers=function(t){var n,r,i,s;for(r=0;r<this.length;r+=1){n=e(this[r]);i=e(this[r]).getLayers();for(s=0;s<i.length;s+=1)n.setLayer(i[s],t)}return this};e.fn.moveLayer=function(t,n){var r,i,s;for(i=0;i<this.length;i+=1)if(r=e(this[i]),s=r.getLayers(),r=r.getLayer(t))r.index=q(r,s),s.splice(r.index,1),s.splice(n,0,r),0>n&&(n=s.length+n),r.index=n;return this};e.fn.removeLayer=function(t){var n,r,i,s,o;for(r=0;r<this.length;r+=1)if(n=e(this[r]),i=E(this[r]),s=n.getLayers(),o=n.getLayer(t))o.index=q(o,s),s.splice(o.index,1),T(n,i,o,{name:u}),N(n,i,o,{group:u});return this};e.fn.removeLayerGroup=function(t){var n,r,i;e.type(t);var s,o,f,l;if(t!==a)for(r=0;r<this.length;r+=1)if(n=e(this[r]),i=E(this[r]),s=n.getLayers(),o=n.getLayerGroup(t)){for(l=0;l<o.length;l+=1)f=o[l],f.index=q(f,s),s.splice(f.index,1),T(n,i,f,{name:u});delete i.layer.groups[o.name]}return this};e.fn.removeLayers=function(){var t,n;for(t=0;t<this.length;t+=1)e(this[t]),n=E(this[t]),n.layers.length=0,n.layer.names={},n.layer.groups={};return this};e.fn.drawLayer=function nt(t){var n,r,i,s;for(n=0;n<this.length;n+=1)i=e(this[n]),r=h(this[n]),s=i.getLayer(t),nt(i,r,s);return this};e.fn.drawLayers=function(t){var n,r,i=t||{},a,f,l,c,p,d;i.index||(i.index=0);for(t=0;t<this.length;t+=1)if(n=e(this[t]),r=h(this[t])){l=E(this[t]);for(a=0;a<l.transforms.masks;a+=1)n.restoreCanvas();i.clear!==o&&n.clearCanvas();r=l.layers;for(f=i.index;f<r.length&&!(a=r[f],a.index=f,i.resetFire&&(a._fired=o),a._event=!a.disableEvents,c=n,p=a,d=f+1,p&&p.visible&&p._method&&(p._next=d?d:u,p._method.call(c,p)),a._mousedout&&(a._mousedout=o,a._fired=s,a._hovered=o,a.mouseout&&a.mouseout.call(this[t],a),a.cursor&&a._cursor&&n.css({cursor:a._cursor})),a._method===e.fn.drawImage&&a.visible);f+=1);for(a=0;a<l.transforms.masks;a+=1)n.restoreCanvas();a=l.intersects[l.intersects.length-1]||[];f=l.event;c=f.type;a[c]||K[c]&&(c=K[c]);d=a[c];p=l.drag;if(a._event&&a.withinMask===s){if((a.mouseover||a.mouseout||a.cursor)&&!a._hovered&&!a._fired)a._fired=s,a._hovered=s,a.mouseover&&a.mouseover.call(this[t],a),a.cursor&&(a._cursor=n.css("cursor"),n.css({cursor:a.cursor}));d&&!a._fired&&(a._fired=s,f.type=u,d.call(this[t],a));if(a.draggable&&!a.disableDrag&&("mousedown"===c||"touchstart"===c)){a.bringToFront&&(r.splice(a.index,1),a.index=r.push(a));p.layer=a;p.dragging=s;if(p.layer.group&&p.layer.dragGroupWithLayer&&(n=l.layer.groups[p.layer.group]))for(f=0;f<n.length;f+=1)n[f]!==p.layer&&(n[f]._startX=n[f].x,n[f]._startY=n[f].y,n[f]._endX=a._eventX,n[f]._endY=a._eventY,n[f].bringToFront&&(n[f].index=q(n[f],r),r.splice(n[f].index,1),r.splice(-1,0,n[f]),n[f].index=r.length-2));p._startX=a._startX=a.x;p._startY=a._startY=a.y;p._endX=a._endX=a._eventX;p._endY=a._endY=a._eventY;a.dragstart&&a.dragstart.call(this[t],a)}}if(p.layer){if(p.dragging&&("mouseup"===c||"touchend"===c))p.layer.dragstop&&p.layer.dragstop.call(this[t],p.layer),l.drag={};if(p.dragging&&("mousemove"===c||"touchmove"===c))if(p.layer.x=p.layer._eventX-(p._endX-p._startX),p.layer.y=p.layer._eventY-(p._endY-p._startY),p.layer.drag&&p.layer.drag.call(this[t],p.layer),p.layer.group&&p.layer.dragGroupWithLayer&&(n=l.layer.groups[p.layer.group]))for(f=0;f<n.length;f+=1)n[f]!==p.layer&&(n[f].x=p.layer._eventX-(n[f]._endX-n[f]._startX),n[f].y=p.layer._eventY-(n[f]._endY-n[f]._startY))}l.intersects=[]}return this};e.fn.addLayer=function(e){var t,n,r;r=new f(e);for(t=0;t<this.length;t+=1)if(n=h(this[t]))r.layer=s,e=C(this[t],r,e);return this};Y=["width","height","opacity","lineHeight"];Z={};e.fn.animateLayer=function(){function t(e,t,n){return function(){k(n);(!t.animating||t.animated===n)&&e.drawLayers();l[4]&&l[4].call(e[0],n);n._animating=o;t.animating=o;t.animated=u}}function n(e,t,n){return function(r,i){k(n);!n._animating&&!t.animating&&(n._animating=s,t.animating=s,t.animated=n);(!t.animating||t.animated===n)&&e.drawLayers();l[5]&&l[5].call(e[0],r,i,n)}}var r,i,f,l=[].slice.call(arguments,0),c,p;"object"===R(l[0])&&!l[0].layer&&l.unshift(0);"object"===R(l[2])?(l.splice(2,0,l[2].duration||u),l.splice(3,0,l[3].easing||u),l.splice(4,0,l[4].complete||u),l.splice(5,0,l[5].step||u)):(l[2]===a?(l.splice(2,0,u),l.splice(3,0,u),l.splice(4,0,u)):U(l[2])&&(l.splice(2,0,u),l.splice(3,0,u)),l[3]===a?(l[3]=u,l.splice(4,0,u)):U(l[3])&&l.splice(3,0,u));for(i=0;i<this.length;i+=1)if(r=e(this[i]),f=h(this[i]))if(f=E(this[i]),(c=r.getLayer(l[0]))&&c._method!==e.fn.draw){p=I({},l[1]);var d=this[i],v=c,m=void 0;for(m in p)p.hasOwnProperty(m)&&U(p[m])&&(p[m]=p[m].call(d,v,m));L(p,s);L(c);c.style=Z;e(c).animate(p,{duration:l[2],easing:e.easing[l[3]]?l[3]:u,complete:t(r,f,c),step:n(r,f,c)})}return this};e.fn.animateLayerGroup=function(t){var n,r,i=[].slice.call(arguments,0),s,o;for(r=0;r<this.length;r+=1){n=e(this[r]);s=n.getLayerGroup(t);for(o=0;o<s.length;o+=1)n.animateLayer.apply(n,[s[o]].concat(i.slice(1)))}return this};e.fn.delayLayer=function(t,n){var r,i;n=n||0;for(r=0;r<this.length;r+=1)i=e(this[r]).getLayer(t),e(i).delay(n);return this};e.fn.delayLayerGroup=function(t,n){var r,i,s,o;n=n||0;for(i=0;i<this.length;i+=1)if(r=e(this[i]),r=r.getLayerGroup(t))for(o=0;o<r.length;o+=1)(s=r[o])&&e(s).delay(n);return this};e.fn.stopLayer=function(t,n){var r,i;for(r=0;r<this.length;r+=1)(i=e(this[r]).getLayer(t))&&e(i).stop(n);return this};e.fn.stopLayerGroup=function(t,n){var r,i,s,o;for(i=0;i<this.length;i+=1)if(r=e(this[i]),r=r.getLayerGroup(t))for(o=0;o<r.length;o+=1)(s=r[o])&&e(s).stop(n);return this};var et="color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "),tt;for(tt=0;tt<et.length;tt+=1)e.fx.step[et[tt]]=O;J={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};K={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};_("click");_("dblclick");_("mousedown");_("mouseup");_("mousemove");_("mouseover");_("mouseout");_("touchstart");_("touchmove");_("touchend");e.event.fix=function(t){var n,r;t=$.call(e.event,t);if(n=t.originalEvent)if(r=n.changedTouches,t.pageX!==a&&t.offsetX===a){if(n=e(t.target).offset())t.offsetX=t.pageX-n.left,t.offsetY=t.pageY-n.top}else if(r&&(n=e(n.target).offset()))t.offsetX=r[0].pageX-n.left,t.offsetY=r[0].pageY-n.top;return t};Q={arc:"drawArc",bezier:"drawBezier",circle:"drawArc",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",polygon:"drawPolygon",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector"};e.fn.draw=function rt(t){var n,r,i,s;s=new f(t);for(r=0;r<this.length;r+=1)if(n=e(this[r]),i=h(this[r]))t=C(this[r],s,t),s.visible&&(s.fn?s.fn.call(this[r],i,s):s._method!==rt&&s._method.call(n,t));return this};e.fn.clearCanvas=function(e){var t,n=new f(e);for(e=0;e<this.length;e+=1)if(t=h(this[e]))!n.x||!n.y||!n.width||!n.height?(t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this[e].width,this[e].height)):(w(t,n,n.width,n.height),t.clearRect(n.x-n.width/2,n.y-n.height/2,n.width,n.height)),t.restore();return this};e.fn.saveCanvas=function(){var e,t,n;for(e=0;e<this.length;e+=1)if(t=h(this[e]))n=E(this[e]),t.save(),n.savedTransforms=I({},n.transforms);return this};e.fn.restoreCanvas=function(){var e,t,n;for(e=0;e<this.length;e+=1)if(t=h(this[e]))n=E(this[e]),t.restore(),n.transforms=I({},n.savedTransforms);return this};e.fn.restoreCanvasOnRedraw=function(t){var n={layer:s,fn:function(){e(this).restoreCanvas()}};I(n,t);return this.draw(n)};e.fn.rotateCanvas=function it(e){var t,n,r=new f(e),i;for(t=0;t<this.length;t+=1)if(n=h(this[t]))i=E(this[t]),e=C(this[t],r,e,it),r.autosave&&n.save(),g(n,r,i.transforms);return this};e.fn.scaleCanvas=function st(e){var t,n,r=new f(e),i;for(t=0;t<this.length;t+=1)if(n=h(this[t]))i=E(this[t]),e=C(this[t],r,e,st),r.autosave&&n.save(),y(n,r,i.transforms);return this};e.fn.translateCanvas=function ot(e){var t,n,r=new f(e),i;for(t=0;t<this.length;t+=1)if(n=h(this[t]))i=E(this[t]),e=C(this[t],r,e,ot),r.autosave&&n.save(),b(n,r,i.transforms);return this};e.fn.drawRect=function ut(e){var t,n,r=new f(e),i,u,a,l,c;for(t=0;t<this.length;t+=1)if(n=h(this[t]))e=C(this[t],r,e,ut),r.visible&&(p(n,r),w(n,r,r.width,r.height),n.beginPath(),i=r.x-r.width/2,u=r.y-r.height/2,(c=r.cornerRadius)?(r.closed=s,a=r.x+r.width/2,l=r.y+r.height/2,0>a-i-2*c&&(c=(a-i)/2),0>l-u-2*c&&(c=(l-u)/2),n.moveTo(i+c,u),n.lineTo(a-c,u),n.arc(a-c,u+c,c,3*W/2,2*W,o),n.lineTo(a,l-c),n.arc(a-c,l-c,c,0,W/2,o),n.lineTo(i+c,l),n.arc(i+c,l-c,c,W/2,W,o),n.lineTo(i,u+c),n.arc(i+c,u+c,c,W,3*W/2,o)):n.rect(i,u,r.width,r.height),r._event&&D(this[t],n,r),m(this[t],n,r));return this};e.fn.drawArc=function at(e){var t,n,r=new f(e);e=e||{};r.layer&&!r.inDegrees&&360===r.end&&(e.end=r.end=2*W);for(t=0;t<this.length;t+=1)if(n=h(this[t]))e=C(this[t],r,e,at),r.visible&&(p(n,r),w(n,r,2*r.radius),n.beginPath(),n.arc(r.x,r.y,r.radius,r.start*r._toRad-W/2,r.end*r._toRad-W/2,r.ccw),r._event&&D(this[t],n,r),m(this[t],n,r));return this};e.fn.drawEllipse=function ft(e){var t,n,r=new f(e),i=4*r.width/3,o=r.height;r.closed=s;for(t=0;t<this.length;t+=1)if(n=h(this[t]))e=C(this[t],r,e,ft),r.visible&&(p(n,r),w(n,r,r.width,r.height),n.beginPath(),n.moveTo(r.x,r.y-o/2),n.bezierCurveTo(r.x-i/2,r.y-o/2,r.x-i/2,r.y+o/2,r.x,r.y+o/2),n.bezierCurveTo(r.x+i/2,r.y+o/2,r.x+i/2,r.y-o/2,r.x,r.y-o/2),r._event&&D(this[t],n,r),m(this[t],n,r));return this};e.fn.drawPolygon=function lt(e){var t,n,r=new f(e),i=2*W/r.sides,o=W/r.sides,u=o+W/2,a=r.radius*V(i/2),l,c,d;r.closed=s;r.projection&&(r.concavity=-r.projection);for(t=0;t<this.length;t+=1)if(n=h(this[t]))if(e=C(this[t],r,e,lt),r.visible){p(n,r);w(n,r,2*r.radius);n.beginPath();for(d=0;d<r.sides;d+=1)l=r.x+r.radius*V(u),c=r.y+r.radius*X(u),n.lineTo(l,c),r.concavity&&(l=r.x+(a+ -a*r.concavity)*V(u+o),c=r.y+(a+ -a*r.concavity)*X(u+o),n.lineTo(l,c)),u+=i;r._event&&D(this[t],n,r);m(this[t],n,r)}return this};e.fn.drawLine=function ct(e){var t,n,r=new f(e),i,o,u;for(t=0;t<this.length;t+=1)if(n=h(this[t]))if(e=C(this[t],r,e,ct),r.visible){p(n,r);w(n,r,0);i=1;for(n.beginPath();s;)if(o=r["x"+i],u=r["y"+i],o!==a&&u!==a)n.lineTo(o+r.x,u+r.y),i+=1;else break;r._event&&D(this[t],n,r);m(this[t],n,r)}return this};e.fn.drawQuadratic=e.fn.drawQuad=function ht(e){var t,n,r=new f(e),i,o,u,l,c;for(t=0;t<this.length;t+=1)if(n=h(this[t]))if(e=C(this[t],r,e,ht),r.visible){p(n,r);w(n,r,0);i=2;n.beginPath();for(n.moveTo(r.x1+r.x,r.y1+r.y);s;)if(o=r["x"+i],u=r["y"+i],l=r["cx"+(i-1)],c=r["cy"+(i-1)],o!==a&&u!==a&&l!==a&&c!==a)n.quadraticCurveTo(l+r.x,c+r.y,o+r.x,u+r.y),i+=1;else break;r._event&&D(this[t],n,r);m(this[t],n,r)}return this};e.fn.drawBezier=function pt(e){var t,n,r=new f(e),i,o,u,l,c,d,v,g;for(t=0;t<this.length;t+=1)if(n=h(this[t]))if(e=C(this[t],r,e,pt),r.visible){p(n,r);w(n,r,0);i=2;o=1;n.beginPath();for(n.moveTo(r.x1+r.x,r.y1+r.y);s;)if(u=r["x"+i],l=r["y"+i],c=r["cx"+o],d=r["cy"+o],v=r["cx"+(o+1)],g=r["cy"+(o+1)],u!==a&&l!==a&&c!==a&&d!==a&&v!==a&&g!==a)n.bezierCurveTo(c+r.x,d+r.y,v+r.x,g+r.y,u+r.x,l+r.y),i+=1,o+=2;else break;r._event&&D(this[t],n,r);m(this[t],n,r)}return this};e.fn.drawVector=function dt(e){var t,n,i=new f(e),o,u,l,c,d;for(t=0;t<this.length;t+=1)if(n=h(this[t]))if(e=C(this[t],i,e,dt),i.visible){p(n,i);w(n,i,0);o=1;n.beginPath();c=i.x;d=i.y;for(n.moveTo(i.x,i.y);s;)if(u=i["a"+o],l=i["l"+o],u!==a&&l!==a)u=u*i._toRad-W/2,c+=l*r.cos(u),d+=l*r.sin(u),n.lineTo(c,d),o+=1;else break;i._event&&D(this[t],n,i);m(this[t],n,i)}return this};e.fn.drawGraph=function vt(e){var t,n,r=new f(e),i,s,o,a,l,c;for(t=0;t<this.length;t+=1)if((n=h(this[t]))&&r.fn)if(e=C(this[t],r,e,vt),r.visible){p(n,r);i=r.graph;s=r.domain;o=r.range;a=this[t].width;l=this[t].height;s===u&&(s=[u,u]);s[0]===u&&(s[0]=0);s[1]===u&&(s[1]=a);o===u&&(o=[u,u]);o[0]===u&&(o[0]=0);o[1]===u&&(o[1]=l);P(t,n,r,s,o);if("y"===i)for(i=s[0]-r.x;i<=s[1]-r.x;i+=1)a=r.fn(i,r),a===u?(H(this[t],n,r),P(t,n,r,s,o)):n.lineTo(i+r.x,a+r.y);else if("x"===i)for(a=o[0]-r.y;a<=o[1]-r.y;a+=1)i=r.fn(a,r),i===u?(H(this[t],n,r),P(t,n,r,s,o)):n.lineTo(i+r.x,a+r.y);else if("r"===i)for(c=0;c<2*W;c+=W/180)l=r.fn(c,r),i=l*V(c),a=l*X(c),l===u?(H(this[t],n,r),P(n,r,s,o)):n.lineTo(i+r.x,a+r.y);H(this[t],n,r)}return this};e.fn.drawText=function mt(t){var n,r,s=new f(t),o,a,l,c;for(n=0;n<this.length;n+=1)if(e(this[n]),r=h(this[n]))if(t=C(this[n],s,t,mt),s.visible){p(r,s);r.textBaseline=s.baseline;r.textAlign=s.align;B(r,s);!n&&s.maxWidth!==u?o=j(r,s):n||(o=String(s.text).split("\n"));if(!n){a=this[n];c=r;var d=s,m=o,g=void 0,y=void 0,b=/\b(\d*\.?\d*)\w\w\b/gi,y=g=void 0;if(G.text===d.text&&G.font===d.font&&G.fontStyle===d.fontStyle&&G.fontSize===d.fontSize&&G.fontFamily===d.fontFamily&&G.maxWidth===d.maxWidth&&G.lineHeight===d.lineHeight)d.width=G.width,d.height=G.height;else{d.width=c.measureText(m[0]).width;for(g=1;g<m.length;g+=1)y=c.measureText(m[g]).width,y>d.width&&(d.width=y);g=a.style.fontSize;if(d.font){if(y=d.font.match(b))a.style.fontSize=d.font.match(b)[0]}else a.style.fontSize=d.fontSize;d.height=i(e.css(a,"fontSize"))*m.length*d.lineHeight;a.style.fontSize=g}}w(r,s,s.width,s.height);n||(l=s.x,"left"===s.align&&!s.respectAlign?l-=s.width/2:"right"===s.align&&!s.respectAlign&&(l+=s.width/2));for(a=0;a<o.length;a+=1)r.shadowColor=s.shadowColor,c=s.y+a*s.height/o.length-(o.length-1)*s.height/o.length/2,r.fillText(o[a],l,c),"transparent"!==s.fillStyle&&(r.shadowColor="transparent"),r.strokeText(o[a],l,c);s._event?(r.beginPath(),r.rect(s.x-s.width/2,s.y-s.height/2,s.width,s.height),r.restore(),D(this[n],r,s),r.closePath(),v(r,E(this[n]),s)):r.restore()}G=s;return this};e.fn.measureText=function gt(e){var t,n;t=e!==a&&("object"!==R(e)||e.layer)?this.getLayer(e):new f(e);if(e=h(this[0]))B(e,t),n=j(e,t),gt(this[0],e,t,n);return t};e.fn.drawImage=function yt(t){function r(n,r,a){return function(){0===r&&(g.width===u&&g.sWidth===u&&(g.width=g.sWidth=y.width),g.height===u&&g.sHeight===u&&(g.height=g.sHeight=y.height),t&&g.layer&&(t.width=g.width,t.height=g.height),p(a,g),g.sWidth!==u&&g.sHeight!==u&&g.sx!==u&&g.sy!==u?(g.width===u&&(g.width=g.sWidth),g.height===u&&(g.height=g.sHeight),g.cropFromCenter||(g.sx+=g.sWidth/2,g.sy+=g.sHeight/2),g.sx+g.sWidth/2>y.width&&(g.sx=y.width-g.sWidth/2),0>g.sx-g.sWidth/2&&(g.sx=g.sWidth/2),0>g.sy-g.sHeight/2&&(g.sy=g.sHeight/2),g.sy+g.sHeight/2>y.height&&(g.sy=y.height-g.sHeight/2),w(a,g,g.width,g.height),a.drawImage(y,g.sx-g.sWidth/2,g.sy-g.sHeight/2,g.sWidth,g.sHeight,g.x-g.width/2,g.y-g.height/2,g.width,g.height)):(w(a,g,g.width,g.height),a.drawImage(y,g.x-g.width/2,g.y-g.height/2,g.width,g.height)));a.beginPath();a.rect(g.x-g.width/2,g.y-g.height/2,g.width,g.height);g._event&&D(i[r],a,g);g._transformed&&a.restore();m=E(i[r]);a.closePath();a.stroke();d(a,m,g);v(a,m,g);g.load&&g.load.call(n,t);g.layer&&g._next&&e(n).drawLayers({clear:o,resetFire:s,index:g._next})}}var i=this,a,l,c,m,g=new f(t),y,b;a=g.source;b=a.getContext;a.src||b?y=a:a&&(G.source===a?y=G._source:(y=new n,y.src=a,G.source=a,G._source=y));for(l=0;l<i.length;l+=1)if(a=i[l],c=h(i[l]))t=C(i[l],g,t,yt),g.visible&&y&&(y.complete||b?r(a,l,c)():(e(y).bind("load",r(a,l,c)),y.src=y.src));return i};e.fn.createPattern=e.fn.pattern=function(t){function r(){l=s.createPattern(a,o.repeat);o.load&&o.load.call(i[0],l)}var i=this,s,o=new f(t),a,l,c;(s=h(i[0]))?(c=o.source,U(c)?(a=e("<canvas />")[0],a.width=o.width,a.height=o.height,t=h(a),c.call(a,t),r()):(t=c.getContext,c.src||t?a=c:(a=new n,a.src=c),a.complete||t?r():(e(a).bind("load",r),a.src=a.src))):l=u;return l};e.fn.createGradient=e.fn.gradient=function(e){var t;e=new f(e);var n=[],r,i,s,o,l,c,p;if(t=h(this[0])){e.x1=e.x1||0;e.y1=e.y1||0;e.x2=e.x2||0;e.y2=e.y2||0;t=e.r1!==u||e.r2!==u?t.createRadialGradient(e.x1,e.y1,e.r1,e.x2,e.y2,e.r2):t.createLinearGradient(e.x1,e.y1,e.x2,e.y2);for(o=1;e["c"+o]!==a;o+=1)e["s"+o]!==a?n.push(e["s"+o]):n.push(u);r=n.length;n[0]===u&&(n[0]=0);n[r-1]===u&&(n[r-1]=1);for(o=0;o<r;o+=1){if(n[o]!==u){c=1;p=0;i=n[o];for(l=o+1;l<r;l+=1)if(n[l]!==u){s=n[l];break}else c+=1;i>s&&(n[l]=n[o])}else n[o]===u&&(p+=1,n[o]=i+p*((s-i)/c));t.addColorStop(n[o],e["c"+(o+1)])}}else t=u;return t};e.fn.setPixels=function bt(e){var t,n,r,i=new f(e),s={},o,a,l,c;for(n=0;n<this.length;n+=1)if(t=this[n],r=h(t)){e=C(t,i,e,bt);w(r,i,i.width,i.height);if(i.width===u||i.height===u)i.width=t.width,i.height=t.height,i.x=i.width/2,i.y=i.height/2;if(0!==i.width&&0!==i.height){o=r.getImageData(i.x-i.width/2,i.y-i.height/2,i.width,i.height);a=o.data;c=a.length;s=[];if(i.each)for(l=0;l<c;l+=4)s.r=a[l],s.g=a[l+1],s.b=a[l+2],s.a=a[l+3],i.each.call(t,s),a[l]=s.r,a[l+1]=s.g,a[l+2]=s.b,a[l+3]=s.a;r.putImageData(o,i.x-i.width/2,i.y-i.height/2);r.restore()}}return this};e.fn.getCanvasImage=function(e,t){var n=this[0];t===a&&(t=1);return n&&n.toDataURL?n.toDataURL("image/"+e,t):u};e.support.canvas=e("<canvas />")[0].getContext!==a;l.defaults=F;l._detectEvents=D;l.closePath=m;e.jCanvas=l})(jQuery,document,Image,Math,parseFloat,!0,!1,null);

/* 
 * Sketch.js - Canvas drawing plugin for jQuery
 * Copyright (C) 2011 by Michael Bleigh and Intridea, Inc.
 */
 var __slice=Array.prototype.slice;(function(e){var t;e.fn.sketch=function(){var n,r,i;r=arguments[0],n=2<=arguments.length?__slice.call(arguments,1):[];if(this.length>1){e.error("Sketch.js can only be called on one element at a time.")}i=this.data("sketch");if(typeof r==="string"&&i){if(i[r]){if(typeof i[r]==="function"){return i[r].apply(i,n)}else if(n.length===0){return i[r]}else if(n.length===1){return i[r]=n[0]}}else{return e.error("Sketch.js did not recognize the given command.")}}else if(i){return i}else{this.data("sketch",new t(this.get(0),r));return this}};t=function(){function t(t,n){this.el=t;this.canvas=e(t);this.context=t.getContext("2d");this.options=e.extend({toolLinks:true,defaultTool:"marker",defaultColor:"#000000",defaultSize:5},n);this.painting=false;this.color=this.options.defaultColor;this.size=this.options.defaultSize;this.tool=this.options.defaultTool;this.actions=[];this.action=[];this.canvas.bind("click mousedown mouseup mousemove mouseleave mouseout touchstart touchmove touchend touchcancel",this.onEvent);if(this.options.toolLinks){e("body").delegate('a[href="#'+this.canvas.attr("id")+'"]',"click",function(t){var n,r,i,s,o,u,a;r=e(this);n=e(r.attr("href"));s=n.data("sketch");a=["color","size","tool"];for(o=0,u=a.length;o<u;o++){i=a[o];if(r.attr("data-"+i)){s.set(i,e(this).attr("data-"+i))}}if(e(this).attr("data-download")){s.download(e(this).attr("data-download"))}if(e(this).attr("data-clear")){s.clear()}return false})}}t.prototype.download=function(e){var t;e||(e="png");if(e==="jpg"){e="jpeg"}t="image/"+e;return window.open(this.el.toDataURL(t))};t.prototype.clear=function(){this.actions=[];return this.redraw()};t.prototype.set=function(e,t){this[e]=t;return this.canvas.trigger("sketch.change"+e,t)};t.prototype.startPainting=function(){this.painting=true;return this.action={tool:this.tool,color:this.color,size:parseFloat(this.size),events:[]}};t.prototype.stopPainting=function(){if(this.action){this.actions.push(this.action)}this.painting=false;this.action=null;return this.redraw()};t.prototype.onEvent=function(t){if(t.originalEvent&&t.originalEvent.targetTouches){if(t.type==="touchend"){t.pageX=t.originalEvent.pageX;t.pageY=t.originalEvent.pageY}else{t.pageX=t.originalEvent.targetTouches[0].pageX;t.pageY=t.originalEvent.targetTouches[0].pageY}}e.sketch.tools[e(this).data("sketch").tool].onEvent.call(e(this).data("sketch"),t);t.preventDefault();return false};t.prototype.redraw=function(){var t;this.el.width=this.canvas.width();this.context=this.el.getContext("2d");t=this;e.each(this.actions,function(){if(this.tool){return e.sketch.tools[this.tool].draw.call(t,this)}});if(this.painting&&this.action){return e.sketch.tools[this.action.tool].draw.call(t,this.action)}};return t}();e.sketch={tools:{}};e.sketch.tools.marker={onEvent:function(e){switch(e.type){case"mousedown":case"touchstart":this.startPainting();break;case"mouseup":case"mouseout":case"mouseleave":case"touchend":case"touchcancel":this.stopPainting()}if(this.painting){this.action.events.push({x:e.pageX-this.canvas.offset().left,y:e.pageY-this.canvas.offset().top,event:e.type});return this.redraw()}},draw:function(e){var t,n,r,i,s;this.context.lineJoin="round";this.context.lineCap="round";this.context.beginPath();this.context.moveTo(e.events[0].x,e.events[0].y);s=e.events;for(r=0,i=s.length;r<i;r++){t=s[r];this.context.lineTo(t.x,t.y);n=t}this.context.strokeStyle=e.color;this.context.lineWidth=e.size;return this.context.stroke()}};return e.sketch.tools.eraser={onEvent:function(t){return e.sketch.tools.marker.onEvent.call(this,t)},draw:function(t){var n;n=this.context.globalCompositeOperation;this.context.globalCompositeOperation="copy";t.color="rgba(0,0,0,0)";e.sketch.tools.marker.draw.call(this,t);return this.context.globalCompositeOperation=n}}})(jQuery);